\cleartooddpage[\thispagestyle{empty}]
\newcommand{\EReco}{$\textrm{E}_{\textrm{Reconstructed}}$}
\newcommand{\ETrue}{$\textrm{E}_{\textrm{True}}$}

\chapter{Gamma Ray Reconstruction Methods}\label{ch:grrecon}

In Chapter \ref{chapter:veritas}, it was explained how the trigger system initializes the readout of PMT voltage traces.
To reconstruct gamma rays, the voltage traces induced by Cherenkov photons must be identified and combined to form an image of the original Cherenkov shower.
Then the shower images from multiple telescopes can be used to reconstruct the original gamma ray's energy and direction.

\section{Pedestal Variation}
  Before reconstructing any events, the pedestal and pedestal variations must be calculated.
  This is done by artificially triggering all pixels once per second during observations, in order to record events that contain only noise.
  The average of the digital counts (dc) of all noise events for each pixel is then the pedestal.
  From this pedestal, the pedestal variations are then calculated for each pixel as the rms of all the dc counts in all noise events, which can be visualized as the distribution of dc around the mean dc.
  In this context, noise events can be due to night-sky-background photons, or from electronic noise.

\section{Pixel Identification}
  The first step is to determine which pixels are part of a shower image.
  This is done by subtracting the dc pedestal from the entire trace, and then summing all trace bins within a fixed window, called the integration length, to get the total dc.

  Most voltage traces have the same general shape: a quickly rising start of the pulse, followed by a longer, slowly falling tail.
  To act as a point of reference in each voltage pulse, the time when the voltage trace is at half of its maximum value is called $T_{0}$.
  The trace is then integrated a second time using a smaller 14 or \SI{24}{ns}-wide time window, starting at $T_0 - 30\%$, to reduce the inclusion of dc from NSB photons and electronic noise.
  This integration is the first of two passes, usually referred to as the double-pass method~\cite{doublepass}.
  If a pixel's first-pass total dc is higher than 5 times the pedestal variation, then it is classified as an image pixel.
  If it is between 2.5 and 5 times the pedestal variation, it is considered a border pixel.

  Once all pixels have been classified, isolated border pixels that have no neighboring image pixel are removed from the image, as they are more likely to be due to noise than Cherenkov photons.
  Then, the time gradient from the image and border pixels can be found by performing a linear fit of the $T_{0}$ times.
  This time gradient can then be used to place a third integration window for a 
with 30\% of the window before each pixel's $T_{0}$, to more accurately measure the charge due to Cherenkov photons in the pixel.
  This third integration window is the second pass in the double-pass method.

  From the image pixels, border pixels, and time gradient, the shower's Hillas parameters~\cite{hillas_params} can be calculated.
  These parameters include the shower size in photoelectrons (or equivalent units), center of charge, angle, length, and width.
  The center of charge is the charge-weighted average of all image and border pixel positions.
  The angle of the shower determines how the image's major axis is oriented in the camera.
  The shower length and width are determined by the rms of the shower image along its major and minor axes, respectively.

\section{Position Reconstruction}\label{subsec:posrecon}
  By examining the images from multiple telescopes, the initial position of the event can be determined.
  This is done by overlapping all telescope images in a single camera coordinate system, and projecting each image's major axis backward in time.
  These axes should intersect very close together, and the average of the intersection points determines the event's initial direction.

  In averaging the intersection points, weighting for each intersection can be applied based on the angle between the two lines.
  This improves the reconstruction, because the intersection point from two images at \ang{90} angles will be less sensitive to image fluctuations than two images at \ang{160}, as shown in Figure~\ref{fig:largeintersectangle}.
  Additionally, the disp method described in Section~\ref{subsec:disp} was explored to provide improvements at lower telescope elevations, though no significant benefit was achieved.

  \begin{figure}[!t]
    \centering
    \includegraphics[width=0.95\textwidth]{images/large_angle_image_intersection_error/laiie_cropped.pdf}
    \caption[Large Image Intersection Angles]{
      In diagram (a), when a noisy pixel is added to an image, the reconstructed position is only moved a small distance (the purple arrow).
      In diagram (b), due to the large angle between images, the error in the reconstructed position is much larger.
    }
    \label{fig:largeintersectangle}
  \end{figure}
  \FloatBarrier

  \subsection{Angular Reconstruction with Boosted Decision Trees}\label{subsec:disp}
    At high elevations, shower images often form small intesection angles, because the telescopes are spread out in two dimensions, relative to the shower in the atmosphere.
    At low elevations near the Galactic Center, however, the telescope array flattens into one dimension, which makes the shower's impact parameter (the shortest distance between the telescope and the shower core axis) smaller for two of the telescopes.
    These two closer telescopes then have very short, almost circular images, which increases the sensitivity of those two image axes to noisy pixels or shower fluctuations, as shown in Figure~\ref{fig:showerhighlowelev}.
    This also causes the remaining telescope images to have large intersection angles, which also reduces the accuracy of the position reconstruction.

    \begin{figure}[!t]
      \centering
      \includegraphics[width=0.75\textwidth]{images/high_elevation_vs_low_shower_images_cropped.eps}
      \caption[Shower Images at High and Low Elevations]{
        In Figure (a), high elevation showers produce long images in all four telescopes.
        In Figure (b), lower elevation showers produce shortened images in two telescopes, and the remaining images form large angle intersection.
      }
      \label{fig:showerhighlowelev}
    \end{figure}

    To better handle these near-parallel image axes at low elevations, the reconstructed position can be determined from more parameters than just the weighted intersection points from the image axes.
    From simulations, the distance between the center of the Hillas shower image and the true position can be calculated, where the angular distance between the two is the disp parameter~\cite{Senturk:2011}, shown in Figure~\ref{fig:dispdiagram}.
    Then, this disp parameter can be provided to a machine learning algorithm~\cite{Beilicke2012NIM}, along with other image parameters like:
    \begin{description}[noitemsep]
      \item [width:] image angular width
      \item [length:] image angular length
      \item [wol:] $\frac{\textrm{width}}{\textrm{length}}$
      \item [size:] total image dc
      \item [ntubes:] number of pixels in the image
      \item [loss:] fraction of image pixels at the edge of the camera
      \item [asym:] distance between image center-of-dc and the pixel with the highest dc
      \item [tgrad:] the slope of the linear time fit to the pixel arrival times
      \item [cross:] angular distance between the image center and the average intersection point of the image axes.
    \end{description}
  % list of training parameters: grep "AddVariable" $EVNDISPSYS/src/trainTMVAforAngularReconstruction.cpp
  % how variables are calculated: grep -P "fParGeo.+\=" $EVNDISPSYS/src/VImageParameterCalculation.cpp
  % asym: http://inspirehep.net/record/1395717/files/RdelosReyes.pdf
  % Once trained on these parameters, the machine learning algorithm can construct a boosted decision tree for determining any new image's \textit{disp}, which can then be used with the image axes intersections to improve the gamma-ray reconstructed positions.


    \begin{figure}[!t]
      \centering
      \includegraphics[width=0.5\textwidth]{images/disp_parameter/disp_parameter.pdf}
      \caption[Angular Reconstruction Disp]{
        The disp parameter is the angular distance between the center (red dot) of a Hillas image (blue oval) and the true sky position (green dot).
        Generally, longer shower images have a larger disp angle.
      }
      \label{fig:dispdiagram}
    \end{figure}

    % https://veritas.sao.arizona.edu/wiki/index.php/BDT_Angular_reconstruction
    These parameters for thousands of simulated showers can then be used to train boosted decision trees (BDTs) that estimate the disp for a new shower's images.
    This estimated disp can then be used with the image axes intersection points to more accurately reconstruct the original gamma-ray point of origin.
    
    Once the training is complete, it is tested on a separate set of 17,000 simulated events, which have their true and predicted disps plotted in Figure~\ref{fig:disptraining}.
    The x axis describes the true disp value for each event, while the y axis describes the disp value estimated by the BDT, with a black $x=y$ line marked, which represents a perfect 1:1 disp reconstruction.
    As events fall on the $x=y$ line, it can be concluded that the BDTs are able to predict the correct disp value for most images.
    {\color{red} You need to be more precise.  You should show also a one dimensional distribution (or various if you want to divide to True DISP bins) and discuss the resolution obtained?? -Orel}

    % made from screenshot of last slide in Dropbox/Presentations/20160719_Group_Meeting.key
    \begin{figure}[!t]
      \centering
      \includegraphics[width=0.85\textwidth]{images/disp_training/disp_training.eps}
      \caption[Disp BDT Training]{
        The true disp vs the BDT-predicted disp, for \nicetilde17,000 gamma-ray event images in T1, from \SI{500}{\GeV{}} to \SI{200}{\TeV{}}.
      }
      \label{fig:disptraining}
    \end{figure}
    
    {\color{red}(Make a profile plot of the true/BDT disp vs true disp, with 68\% containment errorbars, and talk about it in the text! is there a bias? at what disps??)}

    The small improvement in the position reconstruction due to the disp method can be seen in Figure~\ref{fig:disp_event_offset}.
    With the Geometric (red) events, more are concentrated further from the point source, while with the disp method, a few more are concentrated at the source itself.
    The limited improvement may be due to the use of boosted decision trees, whereas a previous study with this method utilized a lookup table of six parameters\cite{Beilicke2012NIM}.
    
    {\color{red}Again, you need to be more specific. First, it is important to note this is data, it's always good to ''brag`` that your reconstruction method is tested on data.  Second, you need to discuss the actual resolution obtained with both methods and state the improvement achieved with DISP. I think the RMS might be a better test of this and anyway the mean would be too affected by the tail. In fact I think the quantiles are better?? -Orel}
    
    For the analysis described in Chapter~\ref{chapter:analysis}, the disp method is used when reconstructing gamma-ray events.

    \begin{figure}[!p]
      \centering
      \includegraphics[width=0.75\textwidth]{images/disp_event_offset_hists/dispgeom_comparison.eps}
      \caption[DISP Offset Improvement]{
        The fraction of events at different angular offsets from the Crab Nebula and the Galactic Center per solid angle, with Geometric (intersection only) and Disp reconstruction methods.
        Data elevations are the same as in Figure~\ref{fig:datapointingelevations}, while training events were simulated at only \ang{28}.
        {\color{red}(Where is the disp improvement???)}
        {\color{red}(Why is the containment radius worse for disp??)}
        {\color{red}(Redo disp training with 5x events! ??)}
        {\color{red}(change y axis label to Disp/Geometric! ??)}
        {\color{red}(Rerun this histogram for different energies, better to say this had some improvements at some energies or offsets than on average it had no effect.)}
      }
      \label{fig:disp_event_offset}
    \end{figure}
  
  {\color{red}(Find some part of the phase space where DISP offers an improvement, and make plots showing that low energy performance is better, though tradeoff is high energy performance is worse. see https://www.dropbox.com/sh/3w93xgr9g072y2x/AADbIXJZwHFXz40lzslP\_DFVa?dl=0 for the specific plots to remake (??))}
  
  {\color{red}(Also include dispgeom\_comparison\_psftable.crab.png in \$V/thesis/plots , but only focus on my energy range, and switch it to be distributions at each energy)}

  
  \FloatBarrier

\section{Energy Reconstruction}\label{subsec:enrecon}
  To reconstruct the energy of each shower, a lookup table of simulated showers is built.
This database includes the width and length of the shower, how far away its core position is, how bright it was, as well as its reconstructed and true energy.
  By searching through this database for showers that are similar to the one being constructed, then interpolating between shower parameters, the shower's true energy can be reconstructed.


\section{FITS Conversion for Gammalib and CTOOLs}\label{fitsconversion}
  Once gamma rays have been reconstructed with Eventdisplay, they must be exported to Gammalib and CTOOLS~\cite{gammalibctools}.
  This involves converting the event list and instrument response functions (IRFs) to a FITS file format.
  These IRFs consist of the effective areas, the point spread functions, the background models, and the energy dispersion.
  The effective area quantifies the total gamma-ray collection area of the observatory, needed for spectral measurements, and is described in Section~\ref{subsec:effarea}.
  The point spread function (PSF) quantifies the distribution of reconstructed positions for a given true position, which is needed for modeling point sources and extended spatial structures.
  This is described further in Section~\ref{subsec:psf}.
  The background models measure the relative number of observed events in different parts of the camera, and their construction is described in Section~\ref{background_production}.
  The energy dispersion quantifies the distribution of reconstructed energies for a given true energy, and is discussed in Section~\ref{subsec:edisp}.
  
  During the export, several decisions are baked into the event lists and IRFs.
  As this thesis revolves around an analysis at an elevation of \nicetilde{}\ang{30}, the IRFs may rapidly change.
  At this elevation, with VERITAS's field of view of \ang{3.5}, the airmass column density ($\textrm{g}/\textrm{cm}^2$) is 20\% higher at the bottom of the camera than at the top.
  Combined with the fact that a observing target can move several degrees over one \SI{30}{min} observation, this means the airmass can change by 10's of percent over a single 30-minute observation.
  This changing atmosphere would mean the IRFs at the beginning of an observation may be measurably different than at the end of an observation.

  To reduce the impact of this, observations are broken up into 8-minute-long parts.
  For each of these 8 minute parts, IRFs are exported alongside the observation.
  A part's average elevation, azimuth, and night sky background rate are used to select the best-matching IRFs for that part.

  \FloatBarrier
  
  \subsection{Effective Area}\label{subsec:effarea}
    % use effective area as a casual noun!
    % plot of effective area vs energy
    Effective area is the measure of how large an observatory's collection area is, which determines how many gamma rays can be detected per unit time, solid angle, and energy.

    For each point in the parameter space, the effective areas are calculated with many {\color{red}(how many?? -Gernot (probably # corsika showers * number of core rescatters * # camera repositions))} Monte Carlo gamma ray simulations.
    This is done in the shower plane, the plane perpendicular to the line drawn between a pointing target and the center of the observatory.
    The effective area is then calculated via:
    $A=\pi R^2 \frac{N_{\text{survived}}}{N_{\text{simulated}}}$
    where R is the radius of the area within which simulated showers are directed to fall, $N_{\text{simulated}}$ is the number of showers that were initially simulated into the area, and $N_{\text{survived}}$ is the number of simulated showers that pass all cuts.
    This effective area is thus a measure of how much detection area the observatory would have if it had a 100\% detection efficiency, which can then be used in calculating a source's flux.
    In Figure~\ref{fig:effarea_paramspace} shows how the effective area peaks to \nicetilde{}\SI{3e5}{m${}^2$} for \SI{3}{\TeV{}} events at the camera center.

    \begin{figure}[!t]
      \centering
      \includegraphics[width=0.85\textwidth]{images/effarea_plots/effarea_space.pdf}
      \caption[Effective Area Parameter Space]{
        Effective areas at different points in the Energy and Camera Offset parameter space for run 78128.
        Data is shown as the black points, indicating the position of some events from that run in the parameter space.
        The color axis indicates the Effective Area, calculated from simulations, at different gamma-ray energies and distances from the camera center.
      }
      \label{fig:effarea_paramspace}
    \end{figure}

    For the test analyses of the Crab Nebula and the Galactic Center Point Source, the effective areas of all events are shown in Figure~\ref{fig:effarea_usage}.

    \begin{figure}[!t]
      \centering
      \includegraphics[width=0.85\textwidth]{images/effarea_plots/effarea_events.pdf}
      \caption[Effective Areas Used]{
      Illustration of the effective areas used by all events in each analysis.
      From these plots, it is easy to check for events with anomalously high (>\SI{400000}{m${}^2$}) or low (\nicetilde\SI{0}{m${}^2$}) effective areas.
      }
      \label{fig:effarea_usage}
    \end{figure}
  
  \FloatBarrier

  \subsection{Point Spread Function}\label{subsec:psf}

    When reconstructing the source position of each gamma ray, it is necessary to know the uncertainty of the position.
    Primarily, errors in the position come from the randomness of shower images.
    The same gamma ray may develop varying outcomes due to differences in which:
    \begin{itemize}[label=$\bullet$,noitemsep]
      \item particles early in the shower gaining different amounts of energy
      \item angles shower particles scatter at
      \item Cherenkov photons are absorbed by the atmosphere
      \item Cherenkov photons are reflected by the mirrors
      \item Cherenkov photons are converted into PMT photoelectrons
    \end{itemize}
    In the image and position reconstruction, these all means that the same initial gamma ray can develop into a distribution of camera images and reconstructed positions.
    Inversely, a single reconstructed position can come from a distribution of true gamma-ray positions.

    This distribution of reconstructed positions, called the point spread function (PSF), primarily affects the reconstructed shape of gamma-ray emission structures in the sky.
    A singular point source, nominally shaped by a Dirac function, is instead distributed out according to the PSF.
    When searching for an extended source, like a dark matter halo, understanding the distribution of reconstructed positions is important.
    A large PSF on all events, for instance, will artificially expand the observed dark matter halo.

    For VERITAS, the PSF is estimated by simulating many gamma rays, then measuring the distribution of true positions for each reconstructed position.
    The distribution of event positions are fitted with a King function~\cite{king1962} (see Equation~\ref{eqn:king}), as the H.E.S.S. collaboration has noted that the King function better models the longer PSF tails at lower elevations (Section 5.2.2 in Ref. \cite{Mayer2015}).
    The radially-normalized King probability density function is defined as

    \begin{equation} \label{eqn:king}
    \text{PSF}_{king}(r) = \frac{1}{2 \pi \sigma^{2} } \left( 1 - \frac{1}{\gamma} \right) \left( 1 + \frac{ r^{2} }{ 2 \gamma \sigma^{2} } \right)^{-\gamma}
    \end{equation}

    where $r$ is the angular distance from the reconstructed position, $\sigma$ is similar to the width of a gaussian, and $\gamma$ governs how long the tails are.
    A King function fitting algorithm was added to Eventdisplay, that fits the $\gamma$ and $\sigma$ parameters to a set of simulated gamma rays.
    This fits well over almost all of the parameter space.
    In Figure~\ref{fig:psf_paramspace}, the PSF is shown for one Sgr A* run.
    In it, one can see how the PSF containment radius changes vs reconstructed energy and offset from the camera's center.
    Other runs, which have different elevations, azimuths and NSB noise levels will have different values at each point in the energy/offset parameter space.

    % plot of psfs from chunkplot
    \begin{figure}[!ht]
      \centering
      \includegraphics[width=0.85\textwidth]{images/psf_king_plots/psf_parameter_space.pdf}
      \caption[PSF Parameter Space]{
        The 68\% containment radius for the Energy/Offset parameter space for Sgr A* run 78128. 
        The green points are from data, showing a subset of the event locations from run 78128 in the parameter space.
        The color axis is the containment radius, calculated from simulations.
        While events from all energies are shown, only events from \SIrange{4}{70}{\TeV{}} are used (see Section~\ref{sec:crab_analysis}).
      }
      \label{fig:psf_paramspace}
    \end{figure}

    For the Galactic Center and the Crab Nebula analyses, the distribution of 68\% containment radii for all events is shown in Figure~\ref{fig:gc_psf_hist}.

    \begin{figure}[!hb]
      \centering
      \includegraphics[width=0.85\textwidth]{images/psf_gc_eventhist/eventpsf.pdf}
      \caption[Crab and Galactic Center Event PSFs]{
        The 68\% containment radius for all Galactic Center and Crab Nebula events used in this analysis.
        The odd structure is due to the varying effective area at different offsets and energies, which changes the distribution of events in the PSF table, which already has varying.
        The long tails are likely due to events at the edge of the observable energy and offset ranges, where the PSF gets worse.
      }
      \label{fig:gc_psf_hist}
    \end{figure}
  
  \FloatBarrier
  
  \subsection{Background Models}\label{background_production}
  
    A background model is a 3 dimensional function in camera x (in angle, parallel to azimuth), camera y (in angle, parallel to elevation), and energy.
    Each background model is constructed from one of two templates, and the templates are built from dark run observations (see Figure~\ref{fig:gcfieldsofview}).
    These background models calculate the number of expected events in the camera, per unit solid angle, unit time, and unit energy.
    This is used to quantify how many counts are expected in different parts of the camera when observing any target.
    Understanding the background shape of the camera is crucial for properly studying extended sources, like dark matter halos, which may extend several degrees from the Galactic Center.
    Improperly estimating background models can result in fake structures appearing around an astrophysical target.
    Background models with more than three dimensions are also possible, but require many more simulations, and are beyond the scope of this thesis.
    
    The background models used in this analysis are made from two background templates, one for each of the V5/V6 epochs (see Section~\ref{sec:epochs}).
    The templates are constructed from dark observations, detailed in \ref{veritasdata}.
    Each template is made by binning all background events radially by camera position and by their energy, to produce a spectral function.
    This spectral function can be seen in Figure~\ref{fig:background_profile}.
    The radial function at two different energies is shown in Figure~\ref{fig:background_radial}.

    \begin{figure}[!p]
      \centering
      \includegraphics[width=0.6\textwidth]{images/ctools_background/background_construction.eps}
      \caption[CTOOLS Background Fine Energy Bins]{
        The V5 Background's fine energy bins.
        The top plot shows the number of events in each fine energy bin from all background runs.
        The bottom plot shows the background rate, the number of background events divided by the observation time, solid angle, and energy span.
        The black lines show the background rate in each energy bin, while the blue line shows the used background rate after interpolation is applied.
      }
      \label{fig:background_profile}
    \end{figure}

    \begin{figure}[!hb]
      \centering
      \includegraphics[width=0.5\textwidth]{images/ctools_background/radial_profiles.eps}
      \caption[CTOOLS Radial Background Profiles]{
        Radial bin profiles for the V5 background's two large-scale energy bins.
        The blue points are the counts per bin area, while the purple line is a spline interpolation with a 3rd order polynomial.
        The peak and plateau at \ang{0}-\ang{1} is due to the background events not being radially symmetric in the camera, due to the changing atmospheric depth across the camera's field of view.
        For fitting the interpolated curve, the bin values at angles less than \ang{0} and greater than \ang{2.5} are copied from the \ang{0} and \ang{2.5} bins, respectively.
        }
      \label{fig:background_radial}
    \end{figure}
    
    Finally, the spatial and spectral functions $M_{s} \left ( e \right )$ and $M_e \left(x,y,e \right )$ are multiplied together in Equation~\ref{eqn:bck_template}.
    
    \begin{equation}\label{eqn:bck_template}
      f(e,x,y) = A \, \times \, M_{e} \left ( e \right ) \, \times \, M_{s} \left ( x, y, e \right )
    \end{equation} 
    
    The function $f(e,x,a)$ has units of $\frac{\textrm{Number of Counts}}{ \textrm{MeV} \times \textrm{s} \times \textrm{sr} }$.
    The multiplied functions are then scaled with a constant $A$ such that the total integral of the template (integrating across camera x, camera y, and energy) is equal to the original number of counts in the dark runs, as in Equation~\ref{eqn:background_template_function}.
    
    \begin{equation}\label{eqn:background_template_function}
      \textrm{Number of Background Events} = A \, \int \, M_{e} \left ( e \right ) \, \times \, M_{s} \left ( x, y, e \right ) \; dx \: dy \: de
    \end{equation}

    This function $f(e,x,y)$ is the background template in camera x/y, which due to its radial symmetry can then immediatly be used as a CTOOLS background model in RA/Dec.
    Each background template is used in the likelihood analysis as a model multiplied by two free parameters, a normalization factor, and the event energy exponentiated by the spectral index.
    This lets the likelihood fitter scale each run's background model up or down to best match the number of observed events.
    This means the background's absolute value is less important than the relative values in different parts of the camera background or at different energies.
  
  \FloatBarrier

  \subsection{Energy Dispersion}\label{subsec:edisp}
    As events are reconstructed imperfectly, it is important to understand what the distribution of reconstructed energies are for a given true energy.
    This \textit{dispersion in energy} is quantified by an energy migration matrix $E_{i,j}$, where $i$ denotes the $i^{\text{th}}$ reconstructed energy bin, and $j$ denotes the $j^{\text{th}}$ true energy bin.
    The energy migration matrix can be used to account for two significant effects.
    The first is that the reconstruction method introduces biases in the event energy, meaning an event at a given true energy can be reconstructed on average at a higher or lower energy.
    The second effect that is accounted for is the dispersion in the reconstructed energies.
    Gamma rays with the same energy will have their energies reconstructed as a distribution close to the true energy.
    These fluctuations can be due to randomness in air shower development or atmospheric absorption of Cherenkov photons.
    This has the effect of distributing events in each energy bin of a spectra.
    In the gamma-ray spectra of astrophysical sources, which often follow a power law, lower energy bins tend to have more events than higher energy bins.
    This results in lower-energy dispersion contributing more to the higher-energy bins than the higher-energy dispersion contributes to the lower-energy bins.
    When not accounted for, this has the effect that the energy dispersion will harden observed astrophysical spectra.
    In Figure~\ref{fig:migmatrix}, a migration matrix is shown.

    \begin{figure}[!th]
      \centering
      \includegraphics[width=0.85\textwidth]{images/edisp_plots/edisp.pdf}
      \caption[Energy Migration Matrix]{
        An energy migration matrix used with Sgr A* run 82288.
        The reconstructed energy is on the x axis, and the true energy is on the y axis.
        The z (color) axis denotes the interpolated number of simulated events that passed all cuts.
        The dark-blue region from \SIrange{4}{70}{TeV} \EReco{} is the range of energies used in this analysis.
        Events at a given \ETrue{} are reconstructed at a spread of \EReco{}.
        This spread is due to the variability in how air showers develop in the atmosphere.
        Small variations early in the shower can have a large impact on the shower's cherenkov image, meaning the shower can appear as though it was from a higher- or lower-energy gamma ray.
        At the lowest \ETrue{} energies, some showers fluctuate upwards to produce higher amounts of Cherenkov light get reconstructed to higher \EReco{} energies.
        At the highest \ETrue{} energies, showers may be so large that they fill the entire camera, leading to lost photons past the edge of the camera, causing the shower's energy to be reconstructed lower than it actually is.
      }
      \label{fig:migmatrix}
    \end{figure}
  
  \FloatBarrier

\section{Camera Studies}
  The objective of this thesis is search for dark matter via the existence of a gamma-ray halo that is both extended and faint.
  The extension and faintness of the halo, plus the relativly large amount of noise near the Galactic Center, make it a priority for understanding how the VERITAS camera behaves in high-noise conditions.
  In order to better understand the camera's behavior in the reconstruction method, several studies were performed.

  \subsection{Background Structure at the Low Energy Threshold}\label{subsec:bkgstructure}
    To produce background models, events were binned according to their energy, elevation, and camera x and y coordinates.
    As a result of this detailed binning, some new effects were noted.
    First, a series of gamma-like events were selected from observations with no known gamma-ray sources.
    These events were then divided into equal-statistics energy bins.
    For each bin, all the contained events were then binned in camera x and y.

    For a set of high-elevation observations, these backgrounds are shown in Figure~\ref{fig:back_highelev}.
    It can be seen that all events are divided up into 3 equal-statistics energy bins in Figure~\ref{fig:back_highelev}.A.
    Each energy bin is then binned in camera x and y in Figures \ref{fig:back_highelev} B, C, and D.
    At these high elevations, the distribution of events in each energy bin is radially symmetric about the camera center.
    This happens because the gamma ray's point of origin, and its shower image in the camera, are usually several tenths of a degree away from each other.
    In addition, the atmospheric column density is similar in all parts of the camera.
    However, structures start to break the radial symmetry at low energies and elevations.
    The cause of these structures is explored in Section~\ref{subsubsec:diffusesims}.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=\textwidth]{images/ctools/backgrounds_highelev.eps}
      \caption[FITS Background at \ang{50} Elevation]{
        Gamma-like events from 52 observations (approximately \nicetilde20 hours) of M82, between \ang{50} and \ang{52} elevations.
        Events in Figure A are divided into 3 equal-statistics energy bins, and binned in Camera Coordinates in Figures B, C, and D.
        Notice the left-most bin (2\%-34\%) overlaps the histogram peak (at -0.5) in the energy histogram by \nicetilde 30\% of its width, unlike in Figure~\ref{fig:back_lowelev29}.
      }
      \label{fig:back_highelev}
    \end{figure}

    In Figures \ref{fig:back_lowelev29} and \ref{fig:back_lowelev26}, the same plots are constructed for a set of low-elevation (\nicetilde{}\ang{29} and \nicetilde{}\ang{26} respectivly) observations, using dark observations.
    See Section~\ref{background_production}, Figure~\ref{fig:gcfieldsofview}, and Section~\ref{sec:bkgmodels} for more discussion.
    It can be seen that in different energy bins, the background possesses different shapes.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=\textwidth]{images/ctools/backgrounds_lowelev29.eps}
      \caption[CTOOLS Background at \ang{29} Elevation]{
        15 Sagittarius A* Off runs (\nicetilde7.5 observation hours), between elevations $ \ang{27.5} $ and $ \ang{30} $.
        Events are divided into 6 equal-statistics energy bins, of which four are binned in Camera Coordinates in Figures B, C, D, and E.
        Notice the left-most bin (from 2\% to 17\%) does not overlap the peak (at $\textrm{log}_{10}\left ( \textrm{TeV} \right ) \approx 0.3$, unlike in Figure~\ref{fig:back_highelev}.
      }
      \label{fig:back_lowelev29}
    \end{figure}

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=\textwidth]{images/ctools/backgrounds_lowelev26.eps}
      \caption[CTOOLS Background at \ang{26} Elevation]{
        10 Sagittarius A* Off runs (\nicetilde5 observation hours), between elevations \ang{24} and \ang{27.5}. 
      }
      \label{fig:back_lowelev26}
    \end{figure}
  
  These effects are also noticeable in the galactic ($l$,$b$) event maps.
  In Figure~\ref{fig:bkgvsel_crab}, the top plot shows the positions of all events.
  The middle histogram shows the distribution of event energies, and the bottom plot shows the positions of events in a limited energy range, \SIrange{1.5}{3.25}{\TeV{}}.
  The middle plot demonstrates that, as event energy decreases, fewer events are detected.
  When events in this limited energy range are plotted in the bottom plot, a faint deficit appears along the bottom of the camera.
  This faint deficit is due to the \nicetilde20\% higher column density at the low-elevation parts of the camera.
  This higher column density causes air showers to start farther away from the telescopes, where more Cherenkov photons are absorbed, resulting in fewer events being detectable in the lower half of the camera.

  When similar plots are made for the Galactic Center in Figure~\ref{fig:bkgvsel_sgra}, the effect is much stronger, and rotated.
  In the top plot, events are radially symmetric around the source position.
  When only the events from \SIrange{1.5}{3.25}{\TeV{}} are plotted, a much clearer deficit is visible on the lower right part of the plot.
  This area corresponds to the deficit at the bottom of the camera in Figures \ref{fig:back_lowelev29}.B and \ref{fig:back_lowelev26}.B.
  This rotation occurs when converting between camera x/y coordinates (Earth Elevation/Azimuth) and Galactic coordinates ($l$,$b$).
  The degree of rotation also changes throughout individual runs, which further blurs this effect.
  For the Crab plots in Figure~\ref{fig:bkgvsel_crab}, the rotation is only a few degrees, while for Sgr A* in Figure~\ref{fig:bkgvsel_sgra}, it is closer to \ang{70}.
  
  This effect is important to the analysis because it implies that, at the lowest energies, the background rate is not radially symmetric.
  Radial backgrounds (sometimes referred to as acceptances) are typically used in VERITAS, as no other camera x/y or energy dependence had been demonstrated until now.
  As the analysis in this thesis only has a few hours of background observations (see Table \ref{tab:observation_times}), only radially symmetric background templates and models could be constructed, which then required limiting the final analysis to $\geq\SI{4}{\TeV{}}$.
  
  \begin{figure}[!p]
    \centering
    \includegraphics[height=0.85\textheight]{images/background_vs_elevation/background_vs_elevation_srccrab.eps}
    \caption[Background Vs Elevation Crab Nebula]
    {\small 
      Plots of Crab Nebula observations.
      Top: Skymap of all events.
      Middle: Histogram of all events in energy.
      Bottom: Skymap of events from \SIrange{1.5}{3.25}{\TeV{}}.  
      The blue circles centered on the Crab Nebula highlight the radial symmetry of the top plot, and the lack of radial symmetry in the bottom plot.
    }
    \label{fig:bkgvsel_crab}
  \end{figure}

  \begin{figure}[!p]
    \centering
    \includegraphics[height=0.85\textheight]{images/background_vs_elevation/background_vs_elevation_srcsgra.eps}
    \caption[Background Vs Elevation Sgr A*]
    {\small 
      Plots of Sgr A* observations.
      Top: Skymap of all events.
      Middle: Histogram of all event energies.
      Bottom: Skymap of events from \SIrange{1.5}{3.25}{\TeV{}}.  
      The blue circles centered on the Galactic Center highlight the radial symmetry of the top plot, and the lack of radial symmetry in the bottom plot.
    }
    \label{fig:bkgvsel_sgra}
  \end{figure}
  
  \FloatBarrier

  \subsection{Diffuse Simulations}\label{subsubsec:diffusesims}
    Diffuse simulations were performed at similar energies and elevations to see if this effect was still present.
    These consisted of simulating 50,000 gamma rays with CORSIKA~\cite{corsika1998} at 1.4, 1.6, 2, and \SI{5}{\TeV{}}.
    The telescopes were fixed to an (azimuth,elevation) of (\ang{193}, \ang{28}).
    The events themselves were distributed in a diffuse \ang{2.5}-radius disk.
    To approximate a simple gamma-hadron cut, any events with a mean-scaled-width falling outside the range of -2.0 to 0.5 were removed, which eliminates many of the showers that appear proton-like.
    These remaining 'gamma-like' events are then binned in camera coordinates in Figure~\ref{fig:back_simdiffuse}.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=\textwidth]{images/backgrounds_diffuse_vs_data/backgrounds_sims/backgrounds_sims.eps}
      \caption[Diffuse Simulated Backgrounds]{
        The reconstructed positions of diffuse simulated gamma-like events.
        These were all simulated at an elevation of \ang{28}, where each plot uses one of four different initial energies.
        % look for keyword 'crescent' in warp-zeuthen, like: /afs/ifh.de/group/cta/scratch/nkelhos/veripyctools/recon.sim.reproduce_crescent for how those plots are made
      }
      \label{fig:back_simdiffuse}
    \end{figure}

    The ring and crescent structures persist in these diffuse simulations, implying these are physical effects of the atmosphere and camera, rather than a problem with the reconstruction method.
    {\color{red}(But what is the effect? I remember Gernot mentioning something about an edge effect? You should explain it here. --Orel??)}
    {\color{red}(The top-of-camera vs bottom-of-camera differences are due to the atmosphere, but I'm not sure what causes the deficit in the middle at the lower energies... ??)}
    {\color{red}(I am not sure what is the reason for the deficit in the middle. Are simulations always with a wobble? Maybe the showers are very small and always at some distance from the centre of the camera?? -Orel)}
    {\color{red}(Consider playing with the distribution of disps and the radial areas??)}

    This striking effect can be seen in the Galactic Center data in Figure~\ref{fig:bkgvsel_sgra}.
    These structures, and their strong dependency on both the energy and elevation of the telescopes may be a large factor in why the low-energy threshold regime of gamma-ray telescopes is poorly understood.
    Incorporating this effect into the instrument response functions would require creating another batch of diffuse simulations with elevation increments smaller than \ang{5}, and calculating instrument IRFs at these finer elevation increments, and at different camera x, camera y, and energy points in the parameter space, all of which are computationally expensive.
    An alternative solution might be to assemble templates for the camera backgrounds.
    These templates can utilize observations at different elevations to quantify how the template shape changes, and can be built for custom time windows, including accounting for the effects of stars and disabled pixels, which are discussed in the next subsection.
    However, due to time constraints these templates were not constructed.
    
    A secondary effect of the previously mentioned diffuse simulations may be that the effective area and energy dispersion IRFs may become more accurate.
    Currently, IRFs are calculated by simulating gamma rays in the atmosphere at a single elevation and azimuth, and then wobbling the cameras away from these events by a fixed angle $W$, typically from \SIrange{0.25}{2.0}\degree.
    This wobbling is done randomly, to sample various parts of the camera evenly.
    This means that the calculated effective area and energy dispersion are averages over a ring of radius $W$ around the camera center.
    The above affect in the previous paragraphs shows that at a fixed elevation, different parts of the camera possess different background rates.
    This implies that the effective areas of the background protons and electrons change with respect to camera x and camera y.
    Since this is an effect of the atmosphere's changing depth, it hints that the \textit{gamma-ray} effective areas also change with respect to camera x and camera y.
    And, since different parts of the camera are sensitive to different energies (due to the changing atmosphere), using diffuse simulations in different parts of the camera may improve the accuracy energy dispersion as well.
    This improved energy dispersion could, for example, be used to more precisely determine the falloff energy of a gamma-ray source's energy spectrum, or potentially reduce the systematic uncertainty in the gamma-ray energy reconstruction.
  
  \FloatBarrier

  \subsection{Effect of Stars}
    Understanding the camera's background is important for accurately modeling extended sources like dark matter halos.
    The camera's background shape is due to the performance of many individual camera pixels working together.
    VERITAS onsite operators had, in the past, noted that for apparent visible magnitude $m_V :$ 6-8 stars, the camera pixels they illuminated would have a higher average current.
    This causes higher pedestal variations in the affected pixels, which decrease how often the pixel participated in shower images.
    In addition, if a star with $m_V < 6$ was in the field of view, it would cause a high enough current in the pixel to trigger a safety system that lowers its voltage to zero, to prevent it from being damaged.
    For particularly bright stars, such as $m_V \leq 3$, several pixels can be disabled at any given time.

    Compounding this effect is that, since the telescope camera is fixed to the ground, the sky rotates around the camera center.
    This means that over a single 30 minute observation the field of view rotates around the camera center, and each star in view disables successive camera pixels as it passes over them.
    The camera rechecks these disabled pixels roughly once per minute by turning their voltage back on and monitoring the current, and resetting it to zero if the current is still above the threshold.

    These effects imply that to study the effect of stars, one must study the effect of high-current and disabled camera pixels, and use this information to construct the effect of stars.
    In the following section, the effects of disabled camera pixels are studied.
    
  \subsection{Effects of Disabled Pixels}


    % see calculations/disabledpixel_obstime , those 250 crab runs turned into about 13.5 observation hours
    To examine the effects of disabled pixels, \nicetilde13 hours of Crab Nebula observations were reconstructed twice.
    The first analysis was with the default analysis chain settings, and the second time with a single pixel disabled in all four telescopes.
    This mimics the effect of having a star in the field of view that is bright enough to disable a pixel.
    The purpose of this study is to examine how many events are lost due to a dead pixel.
    If there are bright stars near the Galactic Center, or a large number of disabled pixels in the data, the telescopes would be less sensitive to any dark matter halo.

    After gamma-hadron cuts are applied to both sets of events, studies can be performed on events that only appeared in one set and not the other.
    Some events may only pass gamma-hadron cuts with the pixel enabled ($P_e$), while others only pass when the pxiel is disabled ($P_d$).
    Events that are present both when the pixel is disabled and enabled can also be tested to see how far their reconstructed position moved in the camera.

    In Figure~\ref{fig:dpix_rel_camera}, the relative event rate in the camera is plotted when pixel 115 is disabled in all four telescopes.
    This relative event rate is calculated by binning all $P_d$ and $P_e$ events by their reconstructed position in camera coordinates.
    Then, for each camera coordinate bin, the ratio of the number of events $\frac{P_d}{P_e}$ is calculated.
    It can be seen that there is a loss of events near the disabled pixel (the black circle), with a rate closer to 100\% the farther one goes from the disabled pixel.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=0.8\textwidth]{images/disabled_pixel/relativerate_camera}
      \caption[Relative Event Rate After Disabling Camera Pixels]{
        Event rate in the camera with pixel 115 disabled (denoted by the black circle) in all four telescopes, relative to having all pixels enabled.
        Camera coordinate axes are parallel to azimuth and elevation.
      }
      \label{fig:dpix_rel_camera}
    \end{figure}
    
    When these bins are combined radially around the disabled pixel, a clear loss of events is visible in Figure~\ref{fig:dpix_rel_radial}.
    From this, it can be seen that at \ang{0.1} from the disabled pixel, the relative event rate is almost 7\% lower than when the pixel was enabled.
    From a area-weighted average of all bins within \ang{0.33} of a pixel, the average event rate is approximately 3.1\% lower than when the pixel is enabled.
    Over the entire field of view, disabling one pixel in all four telescopes resulted in 0.7\% fewer events (14900 events vs 15010 per average \SI{20}{minute} observation).
    
    \begin{figure}[!ht]
      \centering
      \includegraphics[width=0.8\textwidth]{images/disabled_pixel/relativerate_radial.pdf}
      \caption[Relative Event Rate After Disabling Camera Pixels]{
        Event rate in the camera with pixel 115 disabled (denoted by the black circle) in all four telescopes, relative to having all pixels enabled.
        X axis shows the angular distance from the disabled pixel.
      }
      \label{fig:dpix_rel_radial}
    \end{figure}

    % see images/disabled_pixel/dead_pixel_calcs/calc.py
    % dead pixel signature: crab run 88721, pixel 216 (voltage gets dropped by more than 50%)
    % also see DQM page for that run (AvgTraceMap plots)
    % 1.3% of pixel-minutes are lost due to disabled pixels (18083/1427286 = 0.0126)
    % calc this for each runlist as a measure of how few star-disabled pixels there are
    % point out this is a better measure of star effects, since this is lower-level than stars,
    %   its how many pixels are disabled for any reason
    
    % in /Volumes/Charybdis/Research/Dead Pixel Statistics/Run Pixel Voltages/
    % each run's data is downloaded via veripy.VeritasDB().run2pixelvoltagecurrents(run)
    %
    % numerator   : $ cat crab/*.dat | awk '$6>0 && $6<600 {print $6}' | wc -l
    % denominator : $ cat crab/*.dat | awk '$6>0           {print $6}' | wc -l
    % 
    % $6>0   : when an entire telescope is cut or offline, all the voltages are -9999ish, so these are removed first
    % $6<600 : 600V is roughly the threshold between enabled and disabled pixels.
    %          Most enabled voltages are around 1000V.
    %          Most disabled pixel voltages are around 300V.
    %
    % ratio of pixel-minutes where pixel voltage < 600V / total pixel-minutes
    % Crab       runs:  37701pixmin/ 2245377pixmin = 1.679% pixel-time lost due to disabled pixels
    % Sgr A*     runs: 127611pixmin/14553421pixmin = 0.877% 
    % Sgr A* Off runs:  28813pixmin/ 2458631pixmin = 1.172%
    
    While this single-pixel loss-of-events effect was notable, it was not incorporated into the main analysis of this thesis.
    This was because for the Galactic Center analyzed in this thesis, there are relatively few disabled pixels.
    For the three observing targets described in Chapter~\ref{chapter:analysis}, the amount of time pixels spend disabled was calculated.
    The Crab Nebula observations had a total of 2,245,377 pixel-minutes, while 37,701 pixel-minutes were lost due to pixels being disabled, about 1.68\%.
    This 1.68\% equates to a loss of 8.4 pixels (out of 499) in each telescope for the duration of an observation.
    For the Sgr A* Off data, the loss rate was lower at 1.17\%, equivalent to losing 5.8 pixels in each telescope.
    For Sgr A*, 0.88\% of pixel-minutes were lost, equivalent to losing 4.4 pixels in each telescope.

    As these disabled pixels are mostly caused by bright stars, a search of bright stars near each observing source may shed some light on why the Crab Nebula loses 1.6\% of its pixels, while Sgr A* and Sgr A* Off lose less.
    Table~\ref{tab:brightstars} shows the brightest stars near each observing source brighter than V${}_{mag}<6.5$.
    While the Crab Nebula has several bright stars including HIP26451 with V${}_{mag} = 2.97$, Sgr A* Off and Sgr A* only have dimmer stars (V${}_{mag}$ 4.28 and 4.53, respectivly).
    Since a one pixel disabled in all telescopes resulted in 0.7\% fewer events, and the Sgr A* observations in this analysis have \nicetilde{}4.4 pixels disabled, a rough estimate for the events lost due to stars near Sgr A* is approximately 3\%.
    {\color{red}(Is 3\% acceptably small?? whats the threshold where it becomes ok to ignore 3\%??)}
    For the Crab Nebula, with its 8.4 lost pixels, loses approximately 5.9\% of nearby events.
    {\color{red}('Nearby` doesn't make sense when pixels are scattered around, should switch to total \% of events lost??)}
    Note however, that the majority of these event losses are not gamma rays from the observing target, but are instead lost background events near (<\ang{0.5}) the position of the stars that disabled pixels.
    Another reason these disabled pixels are not accounted for is discussed in Chapter~\ref{chapter:analysis}, where small disabled-pixel effect is dwarfed by the problems with modeling how the background rate is affected by the atmospheric gradient.
    Future analyses may be able to account for these effects in their models of the background rates and effective areas.

    \begin{table}[t]
      \centering
      \begin{tabular}{|l|l|r|r|}
        \hline
        \textbf{Source} & \textbf{Star} & \textbf{Distance} & \textbf{V${}_{mag}$} \\ 
                        &               & [deg]             &                      \\
        \hline
        Crab Nebula & HIP26451 & 1.13 & 2.97 \\
                    & HIP25539 & 1.60 & 4.88 \\
                    & HIP26248 & 2.04 & 5.37 \\
                    & HIP26072 & 1.55 & 6.19 \\
                    & HIP26964 & 2.35 & 6.23 \\
                    & HIP25806 & 0.99 & 6.29 \\
                    & HIP26853 & 1.86 & 6.35 \\
                    & HIP26616 & 1.17 & 6.42 \\
        \hline
        Sgr A* Off  & HIP85423 & 1.18 & 4.28 \\
                    & HIP85084 & 0.87 & 5.30 \\
                    & HIP85442 & 1.12 & 5.98 \\
                    & HIP84445 & 2.08 & 6.20 \\
        \hline
        Sgr A*      & HIP87072 & 1.25 & 4.53 \\
                    & HIP87836 & 2.60 & 5.76 \\
                    & HIP87163 & 2.12 & 6.31 \\
                    & HIP86725 & 1.24 & 6.40 \\
        \hline
      \end{tabular}
      \caption[Bright Stars in the Fields of View]{
        A list of nearby stars for each observing source in this analysis.
        The source column is star's closest source.
        The 2nd column is the star's Hipparcos catalogue code.
        The 3rd column is the angular radius between the star and the source, in degrees.
        The 4th column is the visual magnitude, taken from Ref.~\cite{hipparcos_catalogue}.
        Rows are sorted by source, then visual magnitude.
        Only stars brighter than V${}_{mag}=$ 6.5 are shown.
        % table generated with ~/Dropbox/Research/Thesis/images/disabled_pixel/stars_in_fov/fovstars.py
      }
      \label{tab:brightstars}
    \end{table}

    In Figure~\ref{fig:dpix_disappear}, the positions of events that were rejected by cuts are shown.
    The white area indicates many events are lost in the area of the disabled pixel.
    These events would have smaller images, and would be much more susceptable to being cut.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=0.8\textwidth]{images/disabled_pixel/disappearing_events}
      \caption[Events That Disappear when Disabling Camera Pixels]{
        Positions of events that disappeared when pixel 115 was disabled in all four telescopes.
        Positions are from their pixel-enabled reconstructed position.
      }
      \label{fig:dpix_disappear}
    \end{figure}

    In Figure~\ref{fig:dpix_appear}, the positions of events that are now able to pass cuts are shown.
    It should be noted that these are not events that were 'created' by disabling a pixel.
    Rather, they are events that, with the pixel enabled, did not pass cuts.
    Now that the pixel is disabled, they do pass cuts.

    What is also noticeable is that the highest concentration of lost events was in the pixel's area, whereas the highest rate for appearing events is actually in a ring with a radius of \nicetilde1.5 pixels around the disabled pixel.
    This is probably due to the fact that disabling a pixel can make some images look thinner or wider, depending on where the disabled pixel is in the image.
    A thinner image will look more gamma-like, making it more likely to pass cuts.
    On the other hand, a wider image looks more hadron-like, and is less likely to pass cuts, causing some events to disappear.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=0.8\textwidth]{images/disabled_pixel/appearing_events}
      \caption[New Events that Appear when Disabling Camera Pixels]{
        Positions of new events that appeared when pixel 115 was disabled in all four telescopes.
        Positions are from their pixel-disabled reconstructed position.
      }
      \label{fig:dpix_appear}
    \end{figure}

    In Figure~\ref{fig:dpix_move}, the movement of gamma-like events is shown, when pixel 115 was disabled in all four telescopes.
    Only events which moved more than 10\% of the PSF are shown.
    It should be noted that relatively few (0.7\%, or 117 out of the 15010 events in an average 20-minute long Crab Nebula run) move more than this, and the events that do move are mostly ones with non-compact image shapes that are amputated when a pixel is disabled.

    What can be learned from this is that a negligbly small number of events' positions depend on a given pixel.
    Though, interestingly, disabled pixels have an impact on events' reconstructed positions, even from halfway across the camera.
    This may imply that the gamma-ray PSF is, to second order, dependent on the number of disabled pixels, though no studies were done to confirm this.

    \begin{figure}[!ht]
      \centering
      \includegraphics[width=0.7\textwidth]{images/disabled_pixel/moving_events}
      \caption[Event Movement After Disabling Camera Pixels]{
        Positions of events that moved when pixel 115 (denoted by the red circle) was disabled in all four telescopes.  
        Arrows point from the pixel-enabled position to the pixel-disabled position.
      }
      \label{fig:dpix_move}
    \end{figure}

    As the acceptance for a particular event and the event's effective area are strongly related, the loss of acceptance also means a loss of effective area near the pixel.
    This can have effects on the energy reconstruction.
    Additionally, for CTA and its projected \ang{7} diameter field of view, more stars will be in the field of view, implying there will be more camera pixels affected by their light.
    
    From these studies, it can be seen that the loss of a single pixel does not significantly reduce the overall event rate, but does decrease the event rate by \nicetilde{}3\% near (<\ang{0.3}) the position of stars that are brighter than magntiude 6.5.
    For the Galactic Center, only 1\% of the pixels are disabled, equivalent to 5 pixels in each telescope on average.
    % 2320620 disabled pixelseconds out of 214657920 total pixelseconds in the Sgr A* runlist
    % 2320620 / 214657920 = 0.0108 fraction of time lost
    % 499 * 0.0108 = 5.38 pixels in each telescope
    % see $VERIPY/thesis/analysis/find_dead_pixels_near_GC/find.py
    As this study indicates the number of events lost is small, and there are relatively few dead pixels in the Galactic Center's field of view, the effect of dead pixels can be ignored in the dark matter search.

    Future studies could also compare how events move in energy when a pixel is disabled.
    Another study might investigate how the reconstructed shower-telescope distance changes, since a shower with fewer pixels will look further away, and may be reconstructed differently.
    Another possibility is that, for VERITAS or future CTA observations where pixels are disabled (either due to stars or maintainance), customized background models can be constructed that account for the specific configuration of disabled pixels.
    Since the disabled pixel information (which pixels and the disable/enable times) is saved as part of regular obseravtion monitoring, this can be used to apply gaussian event-rate penalties to any background models.
    In general, when a pixel is disabled, it is expected that lower energy events and showers further away will be more vulnerable, and will show stronger differences than higher energy events or closer showers.


