\cleartooddpage[\thispagestyle{empty}]
\chapter{Veritas}

\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.95\textwidth]{images/veritas_array_v6}
    \caption[VERITAS Array]{The VERITAS observatory.}\label{fig:veritasarray}
  \end{center}
\end{figure}

VERITAS is an arrary of four Imaging Atmospheric Cherenkov Telescopes, each spaced $\nicetilde50m$ apart.
Each telescope possesses an array of 345 mirrors, and a 499-Photomultiplier-Tube camera out on a boom.
Each mirror focuses gathered photons onto a separate pixel in the camera.
In Section \ref{sec:hardware}, the different hardware components are discussed.
In Section \ref{sec:trig}, the different trigger levels are discussed.
The methods for image reconstruction are discussed in Section \ref{sec:imgrecon}.
In Section \ref{sec:recon}, the reconstruction used in different parts of the analysis are discussed, including the per-telescope image reconstruction in Subsection \ref{subsec:imgrecon}, the direction reconstruction in Subsection \ref{subsec:posrecon}, and the energy reconstruction in Subsection \ref{subsec:enrecon}.


\section{Hardware}\label{sec:hardware}
When a gamma-ray produces an air shower in the atmosphere, the shower emits numerous Cherenkov photons, over a time period of nanoseconds.
This means that when the image of the shower reaches the telescopes, only a handful of Cherenkov photons remain, and these photons are spread out over several nanoseconds.
Detection of these limited number of photons over such a tiny span of time are what drive the majority of the design of the VERITAS observatory.

To detect these individual Cherenkov photons, Photomultiplier tubes are used to amplify the signal from single photons.
This produces an analog voltage pulse that then must be digitized.
As the voltage pulses widths are kept to ~ns, to prevent them from overlapping the pulses from photons of other showers, the digization hardware measures each voltage pulse in 1-nanosecond-wide time bins.
Though faint showers may only posess a few photons, brighter showers can still shine several thousand photons onto individual pixels.
This means that the digization hardware must be able to handle a large dynamic range of inputs, over several orders of magnitude.
To accomplish this, two amplification levels are used in the digization circuit, High Gain for voltage pulses of a few photons, and Low Gain for voltage pulses of several thousand photons.

\subsection{Telescope Pointing}

\subsection{Mirrors}

\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.95\textwidth]{images/single_telescope}
    \caption[Single Telescope]{View of the 345 mirrors, the support structure, and the PMT Camera housing at the end of the four supporting arms.}\label{fig:davcottel}
  \end{center}
\end{figure}

When cherenkov light first interacts with the telescope array, it is by being reflected by one of 345 mirrors
These mirrors face towards the incoming cherenkov light, with the PMTs positioned in a camera box, facing the mirrors, shown in figure \ref{fig:davcottel}.
This configuration is referred to as a Davies-Cotton telescope \cite{daviescotton}.
Each mirror has an area of 0.322$m^2$, and a spherical curvature radius of 24m.
The mirrors are each mounted along the support structure so that the total diameter of the telescope mirror area is 12m, with a focal length of 12m, and a total mirror area of 111$m^2$ \cite{Veritas_Detector}.
The mirrors' reflectivity as a function of wavelength is shown in figure \ref{fig:mirreflect}.

\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.75\textwidth]{images/mirror_reflect}
    \caption[Mirror Reflectivity]{Mirror reflectivity as a function of wavelength for each telescope, from \cite{mirrorfacets}.  The VERITAS specifications state that the mirror reflectivity must be $\geq 85\%$ between 280nm and 450nm.}\label{fig:mirreflect}
  \end{center}
\end{figure}

As the mirrors are exposed to the elements, they slowly accumulate dust and scratches.
To combat this, they are cleaned and recoated at regular (yearly??) intervals.
Each mirror is attached to the support structure via three adjustable mounting points, meaning the mirror orientation can be adjusted to point directly on the camera, detailed in \cite{mirroralign}.
This alignment is measured and adjusted at regular intervals, using background stars as a calibration source??.


\subsubsection{Mirror Alignment}

\subsection{PMTs}\label{sec:pmts}

Each telescope has a PMT Camera on the end of four supporting arms, inside a protective housing.
This camera consists of 499 Photo Multiplier Tubes, each with a Winston cone to increase the light collection area for each PMT.
These winston cones can be seen attached to the PMTs in figure \ref{fig:winstcones}.

\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.75\textwidth]{images/winston_cones_t2}
    \caption[Winston Cones]{Hexagonal Winston cones over the circular PMTs, inside the camera housing.}\label{fig:winstcones}
  \end{center}
\end{figure}

To operate, the PMTs are connected to high voltage.

\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.75\textwidth]{images/pmt_models}
    \caption[PMT Models]{The two PMT models used in the VERITAS cameras. \cite{pmtmodels}}\label{fig:pmtmodels}
  \end{center}
\end{figure}

The PMTs' output signals are first sent through an amplifier, before travelling down a \nicetilde45m cable to electronics stationed near the telescope.
The electronics then digitize the signal.

~1000V??


\subsubsection{PMT Gain Flatfielding}

The VERITAS PMTs are all the same model, manufactured by the same company, but there are still differences from PMT to PMT.
These differences cause the same number of input photons to create different output signal voltage pulse shapes.
To account for this, the high voltage of individual(??) PMTs can be varied, so that their pulse shapes are as similar as possible.
Doing this is called Gain Flatfielding.



\subsection{Triggers}\label{sec:trig}

The operation of VERITAS requires digitizing voltage pulses once per nanosecond, per photomultiplier tube.
This means that, with 255 voltage levels, 1 second of raw voltage data would require 2 Terabytes of space.
As this is unfeasable with today's computing systems, only subsets of the raw pixel voltages can be saved.
Thus, VERITAS has a system where the raw data is only saved when certain triggers are met.

The L1 trigger is met when multiple time-binned voltage measurements in a single pixel combine to cross a specified threshold voltage.
At the single pixel level, the signals that are preferred are from multiple photons, close in time.
The background signals that are rejected by this trigger include voltage pulses from ambient photons from the night sky background (NSB) and from human-reproduced background photons (cars, streetlights, illuminated clouds, etc.).
When a pixel's L1 trigger is met, this signal is sent to the L2 trigger system.

The L2 trigger is invoked when several adjacent pixels produce an L1 trigger within a span of several of nanoseconds.
This image trigger, when met, is then sent to the L3 trigger system.

The L3 trigger is invoked when two or more L2 triggers occur within a span of tens of nanoseconds.
This selects for images that are within several telescope fields of view, as well as reducing background images in the form of single muon rings imaging individual telescopes.

Once an L3 trigger is invoked, all pixels have their voltages read out, which have been buffered backwards in time by ?? nanoseconds.


\subsubsection{Deadtime}
When the L3 trigger is invoked and the buffers are being read out, the electronics are unable to store new voltages in the buffers, reducing the amount of time the observatory spends observing gamma rays.
As the deadtime is a fixed time loss per event, the deadtime percent rises with the number of readouts.
This means that at an L3 trigger rate of \nicetilde300Hz, about \nicetilde12\% of the time is lost due to buffer readouts.

\subsubsection{Time Pedestal Calibration}
As all PMTs and signal cables are not identical, there can be differences in how long it takes the signal from a photon striking a PMT to actually be digitized.
This is usually measured by looking at the average arrival time of many events over all camera pixels.
By looking at the average arrival time, this can be subtracted from late pixels.

\subsection{Epochs}\label{sec:epochs}
VERITAS has evolved over several years, making alterations to improve its sensitivity.
In August of 2006??, the fourth telescope was finished, and this is considered the fourth epoch.
Telescope 1 was placed at (-37.6, -23.7), telescope 2 at (44.1, -47.7), telescope 3 at (29.4,60.1), and telescope 4 at (-35.9,11.3), where the coordinate system's origin is at 31.675N, 110.962W??, the X axis points East, and the Y axis points North, and both axes are in meters(??).

In September 2009, telescope 1 was moved to a new position (135.4,-8.61), after it was demonstrated that there would be an improvement in sensitivity.
This is the fifth epoch.

In August 2012, the PMTs in all cameras were replaced with improved PMTs (??) that had a higher quantum efficiency, improving the telescopes ability to resolve images.
Data taken after this time is considered part of the sixth epoch.

As these different epochs have different telescope configurations, the instrument response functions are different, effectivly meaning the three epochs are distinct observatories.


\section{Event Reconstruction}\label{sec:recon}

\subsection{Image Reconstruction}\label{subsec:imgrecon}
Pixels have their peak charge found.
Images are cleaned of extraneous pixels.
The time gradient is fit to each image.
Pixels participating in the image are identified.
Images are identified.

\subsection{Position Reconstruction}\label{subsec:posrecon}
Images have their disp calculated.
The major axis of mulitiple images are traced.
The intersection of the axes, weighted by their disps the angles between axes, can then determine their original position.

\subsection{Energy Reconstruction}\label{subsec:enrecon}
A library of different showers is built, from a variety of elevations, energies, and distances from the camera.
This library can then be used to look up a real shower, find the most similar in elevation, shape, etc, and then reading that shower's library energy.

\section{Sensitivity}
% plot vs energy
Sensitivity is a measure of how difficult it is to get a signifiant detection.
It is often quantified by using simulations to predict the amount of observation time required to detect a simulated source at a given significance level.

\section{Effective Area}
% plot of effective area vs energy
Effective area is the measure of how many gamma rays a telescope can detect.
It is referred to as 'Effective' because the detection efficiency is not 100\% at all energies or all parts of the camera.
Instead it is 'effectivly' how large a detection area a telescope has, if it had perfect detection efficiency.
Different telescopes can use this number to compare roughly how many gamma rays can be detected in a given span of time.

\section{Energy Resolution}
% plot of energy resolution
Gamma rays and protons of different energies can produce similar-looking air showers.
Due to this, the reconstruction software cannot perfectly reconstruct gamma rays, which introduces errors into the different qualities of the gamma rays.
This means that when a gamma ray is reconstructed, it has a chance to be reconstructed at a lower or higher energy.
The consequence of this is that gamma rays of a given reconstructed energy can come from a distribution of true simulated energies.
Typically, simulations are run across a number of energies, and an 2D matrix is assembled, where one axis is the true simulated energy, and the other axis is bins of reconstructed energy.

\section{Point Spread Function}\label{sec:psf}
% plot of psf
In addition to the energy being slightly mis-reconstructed, the source position of the gamma ray can also be misreconstructed.
For a gamma ray telescope, a simple measure of this misreconstruction is to simulate many gamma rays at a single point in the sky, and look at how their reconstructed positions are distributed around that point.
This distribution is referred to as the Point Spread Function.
To first order, most current-generation point spread functions are gaussian distributions.

\section{Energy Dispersion}
Much like the point spread function in section \ref{sec:psf}, the energy reconstruction process is also imperfect.
This means that a gamma ray with a reconstructed energy could come from a distribution of true energies.
This can also be phrased that a group of gamma-rays with the same initial energy will have a distribution of reconstructed energies.
These distributions primarily are due to inherent randomness in the showers themselves.

\section{Energy Sensitivity and Zenith Angle}
% plot of energy sensitivity at 20zen and 65zen

As the telescope points at a lower elevation, the atmospheric volume that can be used to detect air showers greatly increases, leading to an increase in the telescope's effective areafor high energy showers.
The downside is that fewer low-energy gamma rays reach the volume of atmosphere being observed, 

\section{Comparison with Other Observatories}

% sensitivity comparison plots

CTA, HESS, Magic, HAWC, Fermi
